# ğŸ“ Architecture Diagram - Goal Notes System

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   ğŸ–¥ï¸  WEB FRONTEND              ğŸ’¬ ORCHESTRATOR (Chat)             â”‚
â”‚   â”œâ”€ Visualizza obiettivi        â”œâ”€ User: "Aggiungi nota Q1..."   â”‚
â”‚   â”œâ”€ Aggiunge note manualmente   â”œâ”€ Interpreta comando            â”‚
â”‚   â””â”€ Vede storico note           â””â”€ Delega a agent                â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                            â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚     BACKEND PROXY (Flask)                  â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚                                           â”‚
         â”‚  GET  /api/goals/search                  â”‚
         â”‚  POST /api/goals/<id>/notes              â”‚
         â”‚  GET  /api/goals                         â”‚
         â”‚  PUT  /api/goals                         â”‚
         â”‚  POST /api/goals                         â”‚
         â”‚                                           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    AWS LAMBDA FUNCTIONS             â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚                                     â”‚
         â”‚  âœ¨ search_goal.py (NUOVO)         â”‚
         â”‚     â€¢ Ricerca per titolo            â”‚
         â”‚     â€¢ Ritorna goal_id               â”‚
         â”‚     â€¢ Supporta filtri               â”‚
         â”‚                                     â”‚
         â”‚  ğŸ“ post_goal.py (AGGIORNATO)      â”‚
         â”‚     â€¢ Crea goal con nota iniziale  â”‚
         â”‚     â€¢ Inizializza note_history     â”‚
         â”‚                                     â”‚
         â”‚  âœï¸  update_goal.py (AGGIORNATO)   â”‚
         â”‚     â€¢ Aggiunge note a history      â”‚
         â”‚     â€¢ Aggiorna altri campi         â”‚
         â”‚     â€¢ Timestamp automatico         â”‚
         â”‚                                     â”‚
         â”‚  ğŸ—‘ï¸  delete_goal.py                â”‚
         â”‚  ğŸ¯ get_goal.py                    â”‚
         â”‚                                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  AWS DYNAMODB                       â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚                                     â”‚
         â”‚  PersonalGoals Table:               â”‚
         â”‚  â”œâ”€ goal_id (PK)                   â”‚
         â”‚  â”œâ”€ ambito, titolo, descrizione    â”‚
         â”‚  â”œâ”€ scadenza, priorita, status     â”‚
         â”‚  â”œâ”€ metriche, sottotask            â”‚
         â”‚  â”œâ”€ note_history â­ NUOVO          â”‚
         â”‚  â”‚  â””â”€ [{                          â”‚
         â”‚  â”‚      timestamp,                 â”‚
         â”‚  â”‚      note,                      â”‚
         â”‚  â”‚      source (frontend|agent)    â”‚
         â”‚  â”‚    }]                           â”‚
         â”‚  â”œâ”€ created_at, updated_at         â”‚
         â”‚                                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flusso Frontend (Manuale)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    USER CLICKS      â”‚
â”‚  "Modifica Goal"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: editGoal()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  GET /api/goals?goal_id=xxx
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lambda: get_goal.py     â”‚
â”‚  SELECT from DynamoDB    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Response JSON:         â”‚
â”‚   {                      â”‚
â”‚     goal_id: "xxx",      â”‚
â”‚     titolo: "Q1",        â”‚
â”‚     status: "active",    â”‚
â”‚     note_history: [      â”‚
â”‚       {timestamp, note,  â”‚
â”‚        source}           â”‚
â”‚     ]                    â”‚
â”‚   }                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend: Display Modal     â”‚
â”‚  â”œâ”€ Form fields populated    â”‚
â”‚  â”œâ”€ Textarea per nuova nota  â”‚
â”‚  â””â”€ Storico note visualizzatoâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
      User digita nota
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  handleUpdateGoal()      â”‚
â”‚  {                       â”‚
â”‚    goal_id: "xxx",       â”‚
â”‚    note: "testo nota",   â”‚
â”‚    note_source: "frontend" â”‚
â”‚  }                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  PUT /api/goals
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lambda: update_goal.py  â”‚
â”‚  Estrai nota da body     â”‚
â”‚  Carica goal da DynamoDB â”‚
â”‚  Aggiungi a note_history â”‚
â”‚  UPDATE item             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DynamoDB UPDATE        â”‚
â”‚   note_history.append({  â”‚
â”‚     timestamp: now(),    â”‚
â”‚     note: "...",         â”‚
â”‚     source: "frontend"   â”‚
â”‚   })                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Response: Updated Goal â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend:               â”‚
â”‚  âœ… Mostra success       â”‚
â”‚  âœ… Ricarica la lista    â”‚
â”‚  âœ… Chiudi modal         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¤– Flusso Orchestrator (Agent)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER (via Chat)                 â”‚
â”‚  "Aggiungi nota a Q1:            â”‚
â”‚   Ho contattato 10 lead"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Orchestrator Agent              â”‚
â”‚  â€¢ Parse intent                  â”‚
â”‚  â€¢ Identifica agent target:      â”‚
â”‚    project-goal-writer-reader    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    invoke_agent("project_goal_writer_reader",
    "Aggiungi nota a Q1: Ho contattato 10 lead")
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  project-goal-writer-reader      â”‚
â”‚  Agent (Bedrock)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€ Parse richiesta
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Agent Decision:              â”‚
    â”‚  Devo prima trovare il goal   â”‚
    â”‚  per titolo "Q1"              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    invoke search-goal(
        titolo="Q1"
    )
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  MCP Gateway Call            â”‚
    â”‚  POST /mcp                   â”‚
    â”‚  search-goal tool            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    GET /api/goals/search?titolo=Q1
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Lambda: search_goal.py      â”‚
    â”‚  DynamoDB.scan(              â”‚
    â”‚    FilterExpression:         â”‚
    â”‚      titolo contains "Q1"    â”‚
    â”‚  )                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    Response: {
        count: 1,
        goals: [{
            goal_id: "abc-123",
            titolo: "Aumentare fatturato Q1",
            ambio: "Reply",
            note_history: [...]
        }]
    }
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Agent riceve goal_id        â”‚
    â”‚  "abc-123"                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚  Agent decide: ora aggiorna
               â”‚
               â–¼
    invoke update-goal(
        goal_id="abc-123",
        note="Ho contattato 10 lead",
        note_source="agent"
    )
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  MCP Gateway Call            â”‚
    â”‚  PUT /api/goals              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Lambda: update_goal.py      â”‚
    â”‚  1. Load goal (goal_id)      â”‚
    â”‚  2. Aggiorna goal            â”‚
    â”‚  3. Aggiungi nota:           â”‚
    â”‚     note_history.append({    â”‚
    â”‚       timestamp: now(),      â”‚
    â”‚       note: "Ho contattato   â”‚
    â”‚              10 lead",       â”‚
    â”‚       source: "agent"        â”‚
    â”‚     })                       â”‚
    â”‚  4. Save DynamoDB           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  DynamoDB Updated âœ…         â”‚
    â”‚  note_history now has:       â”‚
    â”‚  [{source: "frontend", ...}, â”‚
    â”‚   {source: "agent", ...}]    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Agent Response to           â”‚
    â”‚  Orchestrator:               â”‚
    â”‚  "âœ… Nota aggiunta con       â”‚
    â”‚   successo all'obiettivo Q1" â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Orchestrator â†’ User         â”‚
    â”‚  "Ho aggiunto la nota:       â”‚
    â”‚   'Ho contattato 10 lead'    â”‚
    â”‚   all'obiettivo Q1"          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRONTEND                             â”‚
â”‚                                                          â”‚
â”‚  [Goal List]  [Edit Modal]  [Note Textarea]  [History]  â”‚
â”‚      â”‚             â”‚              â”‚               â”‚     â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                        â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    FETCH/POST
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    BACKEND (Flask)              â”‚
        â”‚                                 â”‚
        â”‚  Routes:                        â”‚
        â”‚  â€¢ GET  /api/goals              â”‚
        â”‚  â€¢ GET  /api/goals/search       â”‚
        â”‚  â€¢ POST /api/goals              â”‚
        â”‚  â€¢ PUT  /api/goals              â”‚
        â”‚  â€¢ POST /api/goals/<id>/notes   â”‚
        â”‚  â€¢ DELETE /api/goals            â”‚
        â”‚                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                  INVOKE LAMBDA
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    AWS LAMBDA FUNCTIONS         â”‚
        â”‚                                 â”‚
        â”‚  â€¢ search_goal.py   â­ NUOVO   â”‚
        â”‚  â€¢ post_goal.py     âœ¨ UPDATE  â”‚
        â”‚  â€¢ get_goal.py                 â”‚
        â”‚  â€¢ update_goal.py   âœ¨ UPDATE  â”‚
        â”‚  â€¢ delete_goal.py              â”‚
        â”‚                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                   QUERY/UPDATE
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   AWS DynamoDB                  â”‚
        â”‚                                 â”‚
        â”‚   PersonalGoals:                â”‚
        â”‚   â€¢ goal_id (PK)                â”‚
        â”‚   â€¢ ambito, titolo              â”‚
        â”‚   â€¢ note_history â­ NUOVO       â”‚
        â”‚     â””â”€ List of:                 â”‚
        â”‚        â”œâ”€ timestamp             â”‚
        â”‚        â”œâ”€ note                  â”‚
        â”‚        â””â”€ source                â”‚
        â”‚   â€¢ altri campi...              â”‚
        â”‚                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ORCHESTRATOR SYSTEM                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                   â”‚
â”‚  When user says:                                  â”‚
â”‚  "Aggiungi nota all'obiettivo Q1: ..."           â”‚
â”‚                                                   â”‚
â”‚  1. Parse intent â†’ project-goal-writer-reader    â”‚
â”‚                                                   â”‚
â”‚  2. Agent calls tools via MCP Gateway:           â”‚
â”‚     â”œâ”€ search-goal(titolo="Q1")                  â”‚
â”‚     â”‚   â†“                                        â”‚
â”‚     â”‚   GET /api/goals/search                    â”‚
â”‚     â”‚   â†“                                        â”‚
â”‚     â”‚   Returns: goal_id="abc-123"               â”‚
â”‚     â”‚                                            â”‚
â”‚     â””â”€ update-goal(                              â”‚
â”‚         goal_id="abc-123",                       â”‚
â”‚         note="Ho contattato...",                 â”‚
â”‚         note_source="agent"                      â”‚
â”‚       )                                          â”‚
â”‚       â†“                                          â”‚
â”‚       PUT /api/goals                             â”‚
â”‚       â†“                                          â”‚
â”‚       Lambda adds note to note_history           â”‚
â”‚       with source="agent"                        â”‚
â”‚                                                   â”‚
â”‚  3. Frontend sees note with ğŸ¤– agent badge      â”‚
â”‚     in note history on next edit                â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Frontend UI Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        EDIT GOAL MODAL                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  Titolo: [Aumentare fatturato Q1]       â”‚
â”‚  Ambito: [Reply          ]               â”‚
â”‚  PrioritÃ : [Alta      ]   Stato: [Active]â”‚
â”‚  Descrizione: [              ]          â”‚
â”‚               [              ]          â”‚
â”‚  Scadenza: [2025-03-31]                 â”‚
â”‚  Metriche: [  {...}  ]                  â”‚
â”‚                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ“ Aggiungi una nota                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Descrivi il progresso o gli        â”‚ â”‚
â”‚  â”‚ aggiornamenti...                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  La nota sarÃ  aggiunta alla history     â”‚
â”‚                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ“‹ Storico Note                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ ğŸ¤– Agent - 21 Gen 2025, 14:15     â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚ â”‚ Completata analisi competitorâ”‚  â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ Frontend - 20 Gen 2025, 10:30  â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚ â”‚ Ho contattato 10 nuovi lead  â”‚  â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â”‚  [ğŸ’¾ Salva Modifiche]  [Annulla]        â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security & Validation

```
USER INPUT
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDATION LAYER    â”‚
â”‚                     â”‚
â”‚ Frontend:           â”‚
â”‚ â€¢ titolo not empty  â”‚
â”‚ â€¢ JSON parse check  â”‚
â”‚ â€¢ Field type check  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND VALIDATION  â”‚
â”‚                     â”‚
â”‚ â€¢ goal_id exists    â”‚
â”‚ â€¢ note not empty    â”‚
â”‚ â€¢ source in list    â”‚
â”‚ â€¢ ambito matches    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAMBDA VALIDATION   â”‚
â”‚                     â”‚
â”‚ â€¢ Parse JSON        â”‚
â”‚ â€¢ Query DynamoDB    â”‚
â”‚ â€¢ Validate response â”‚
â”‚ â€¢ Add timestamp     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE CONSTRAINTSâ”‚
â”‚                     â”‚
â”‚ â€¢ goal_id PK valid â”‚
â”‚ â€¢ Item size < 400KB â”‚
â”‚ â€¢ TTL not set       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
    âœ… DATA STORED
```

---

## ğŸ“ˆ Sequence Diagram - Full Workflow

```
Frontend    Backend    Lambda      DynamoDB
   â”‚          â”‚          â”‚            â”‚
   â”‚          â”‚          â”‚            â”‚
   â”œâ”€GET â”€â”€â”€â”€>â”‚          â”‚            â”‚
   â”‚goals/search?titolo=Q1
   â”‚          â”‚          â”‚            â”‚
   â”‚          â”œâ”€INVOKE â”€â”€>â”‚            â”‚
   â”‚          â”‚           â”œâ”€SCAN â”€â”€â”€â”€>â”‚
   â”‚          â”‚           â”‚<â”€Items â”€â”€â”€â”¤
   â”‚          â”‚<â”€RETURN â”€â”€â”¤            â”‚
   â”‚          â”‚           â”‚            â”‚
   â”‚<â”€RESULT â”€â”¤           â”‚            â”‚
   â”‚ [goal_id]â”‚           â”‚            â”‚
   â”‚          â”‚           â”‚            â”‚
   â”‚ [User edits & adds note]         â”‚
   â”‚          â”‚           â”‚            â”‚
   â”œâ”€PUT â”€â”€â”€â”€>â”‚           â”‚            â”‚
   â”‚  /goals  â”‚           â”‚            â”‚
   â”‚{goal_id, â”‚           â”‚            â”‚
   â”‚note}     â”œâ”€INVOKE â”€â”€>â”‚            â”‚
   â”‚          â”‚           â”œâ”€GET â”€â”€â”€â”€â”€>â”‚
   â”‚          â”‚           â”‚<â”€Item â”€â”€â”€â”€â”¤
   â”‚          â”‚           â”‚            â”‚
   â”‚          â”‚           â”œâ”€UPDATE â”€â”€>â”‚
   â”‚          â”‚           â”‚(append    â”‚
   â”‚          â”‚           â”‚ note to   â”‚
   â”‚          â”‚           â”‚ history)  â”‚
   â”‚          â”‚           â”‚<â”€OK â”€â”€â”€â”€â”€â”€â”¤
   â”‚          â”‚<â”€RESPONSEâ”€â”¤            â”‚
   â”‚          â”‚{goal_id,  â”‚            â”‚
   â”‚          â”‚note_history}          â”‚
   â”‚<â”€OK â”€â”€â”€â”€â”€â”¤           â”‚            â”‚
   â”‚          â”‚           â”‚            â”‚
   â”‚[reload   â”‚           â”‚            â”‚
   â”‚ & show   â”‚           â”‚            â”‚
   â”‚note in   â”‚           â”‚            â”‚
   â”‚history]  â”‚           â”‚            â”‚
   â”‚          â”‚           â”‚            â”‚
```

---

**Last Updated**: 2025-01-20
**Implementation Status**: âœ… Complete

